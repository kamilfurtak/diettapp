
<div class="h-screen w-screen bg-gray-900 flex flex-col font-sans text-gray-100">
  @if (mealService.loading()) {
    <div class="absolute inset-0 bg-gray-900/80 backdrop-blur-sm flex items-center justify-center z-50">
      <div class="flex flex-col items-center space-y-4">
        <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-lime-500"></div>
        <p class="text-lg font-semibold text-gray-200">Loading your data...</p>
      </div>
    </div>
  }

  <header class="bg-gray-800 shadow-md w-full sticky top-0 z-40">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-center h-16">
          <h1 class="text-xl font-bold tracking-tight">
            Diet Tracker
          </h1>
        </div>
      </div>
    </header>

  <main class="flex-1 overflow-y-auto no-scrollbar pb-32">
    @switch (view()) {
      @case ('log') {
        <app-meal-log
          (addMealRequest)="showAddMealView($event)"
          (editPlanRequest)="showPlanView()" />
      }
      @case ('add') {
        <app-add-meal
          [category]="selectedCategory()!"
          (mealAdded)="showLogView()"
          (close)="showLogView()" />
      }
      @case ('plan') {
        <app-diet-plan (close)="showLogView()" />
      }
      @case ('streak') {
        <app-streak />
      }
    }
  </main>

  <footer class="fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 h-16 flex items-center justify-around z-30">
      <button (click)="showLogView()" [class.text-lime-400]="view() === 'log'" [class.text-gray-400]="view() !== 'log'" class="flex flex-col items-center justify-center hover:text-lime-400 transition-colors w-1/5">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-2xl" width="1em" height="1em" viewBox="0 0 512 512">
          <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"
                d="M57.49 47.74l368.43 368.43a37.28 37.28 0 010 52.72h0a37.29 37.29 0 01-52.72 0l-90-91.55A32 32 0 01274 354.91v-5.53a32 32 0 00-9.52-22.78l-11.62-10.73a32 32 0 00-29.8-7.44h0a48.53 48.53 0 01-46.56-12.63l-85.43-85.44C40.39 159.68 21.74 83.15 57.49 47.74z"/>
          <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"
                d="M400 32l-77.25 77.25A64 64 0 00304 154.51v14.86a16 16 0 01-4.69 11.32L288 192M320 224l11.31-11.31a16 16 0 0111.32-4.69h14.86a64 64 0 0045.26-18.75L480 112"/>
        </svg>
        <span class="text-xs font-medium">Log</span>
      </button>
      <button (click)="showStreakView()" [class.text-lime-400]="view() === 'streak'" [class.text-gray-400]="view() !== 'streak'" class="flex flex-col items-center justify-center hover:text-lime-400 transition-colors w-1/5">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-2xl" width="1em" height="1em" viewBox="0 0 512 512">
            <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"
                d="M256 160c16-63.16 76.43-95.41 208-96a15.94 15.94 0 0116 16v288a16 16 0 01-16 16c-128 0-177.45 25.81-208 64-30.37-38-80-64-208-64-9.88 0-16-8.05-16-17.93V80a15.94 15.94 0 0116-16c131.57.59 192 32.84 208 96z"/>
        </svg>
        <span class="text-xs">Streak</span>
    </button>
      <button (click)="showAddMealView('Snacks')" class="flex flex-col items-center justify-center text-gray-400 w-1/5">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-6xl text-lime-400 -mt-8 bg-gray-800 p-1 rounded-full"
             width="1em" height="1em" viewBox="0 0 512 512">
          <path fill="currentColor"
                d="M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm80 224h-64v64a16 16 0 01-32 0v-64h-64a16 16 0 010-32h64v-64a16 16 0 0132 0v64h64a16 16 0 010 32z"/>
        </svg>
      </button>
      <button class="flex flex-col items-center justify-center text-gray-400 opacity-50 w-1/5">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-2xl" width="1em" height="1em" viewBox="0 0 512 512">
          <rect x="64" y="320" width="48" height="160" rx="8" ry="8" fill="none" stroke="currentColor"
                stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
          <rect x="288" y="224" width="48" height="256" rx="8" ry="8" fill="none" stroke="currentColor"
                stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
          <rect x="400" y="112" width="48" height="368" rx="8" ry="8" fill="none" stroke="currentColor"
                stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
          <rect x="176" y="32" width="48" height="448" rx="8" ry="8" fill="none" stroke="currentColor"
                stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
        </svg>
        <span class="text-xs">Stats</span>
      </button>
      <button (click)="showPlanView()" [class.text-lime-400]="view() === 'plan'" [class.text-gray-400]="view() !== 'plan'" class="flex flex-col items-center justify-center hover:text-lime-400 transition-colors w-1/5">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-2xl" width="1em" height="1em" viewBox="0 0 512 512">
          <path fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"
                d="M416 221.25V416a48 48 0 01-48 48H144a48 48 0 01-48-48V96a48 48 0 0148-48h98.75a32 32 0 0122.62 9.37l141.26 141.26a32 32 0 019.37 22.62z"/>
          <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"
                d="M256 56v120a32 32 0 0032 32h120M176 288h160M176 368h160"/>
        </svg>
        <span class="text-xs">Plans</span>
      </button>
    </footer>
</div>
